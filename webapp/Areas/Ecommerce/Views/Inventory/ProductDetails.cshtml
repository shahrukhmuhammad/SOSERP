@model Ecommerce.Entity.Product

@{
    ViewBag.Title = "ProductDetails";
}

@section styles{
    <link href="~/Content/activityStream.css" rel="stylesheet" />
    @if (Request.Browser.IsMobileDevice)
    {
        @Styles.Render("~/Content/SummerNote")
    }
    else
    {
        <link href="~/Content/alloy-editor/assets/alloy-editor-ocean.css" rel="stylesheet" />
    }
}

<div class="user-Profile">
    <div class="row">
        <div class="col-sm-3">
            <img src="~/Content/Uploads/Ecommerce/p_@(Model.ProductId).jpg" class="img-responsive img-centre img-cirlce" onerror="this.onerror = null; this.src = '/Content/Images/img.png';" />
            <div class="btn-group btn-group-lg visible-xs" style="position: absolute; top: -14px; right: 0;">
                <a href="~/Secure/Employee/Record/@*@Model.Id*@" class="btn btn-link text-muted" title="Edit"><i class="fa fa-2x fa-edit"></i></a>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="page-header">
                <h1 style="margin-top:0;">@Model.Title <small>BY <a href="javascript://">@Model.ManufacturerTitle</a></small></h1>
            </div>
            <div class="hidden-xs">
                @Html.Raw(Model.ShortDescription)
            </div>
            <div class="hidden-xs">
                @Html.Raw(Model.Description)
            </div>
        </div>
        <div class="col-sm-3 text-right">
            <div class="btn-group btn-group-vertical fullWidth" role="group">
                <a href="/Ecommerce/Inventory/ProductRecord/@Model.ProductId" class="btn btn-link text-muted"><i class="fa fa-edit"></i> Edit Product</a>
                @*<a href="javascript://" class="btn btn-link text-muted"><i class="fa fa-clipboard"></i> Add To Project</a>*@
                <a href="javascript://" class="btn btn-link text-muted"><i class="fa fa-sticky-note-o"></i> Create Task</a>
                <a href="javascript://" class="btn btn-link text-muted"><i class="fa fa-cubes"></i> View Performance</a>
                <a href="javascript://" class="btn btn-link text-muted"><i class="fa fa-clock-o"></i> View Timesheet</a>
            </div>
        </div>
    </div>
    <div class="row tb-padding">
        <div class="col-sm-9 col-sm-offset-3">
            <div class="circle-btns circle-btnsNew">
                    <a class="active" href="#summary" aria-controls="summary" role="tab" data-toggle="tab" onclick="$(this).parent().find('a').removeClass('active'); $(this).addClass('active');">
                        <p class="title">Details</p>
                    </a>
                    <a href="#schedules" aria-controls="schedules" role="tab" data-toggle="tab" onclick="$(this).parent().find('a').removeClass('active'); $(this).addClass('active');">
                        <p class="title">Sale</p>
                    </a>
                    <a href="#timesheet" aria-controls="timesheet" role="tab" data-toggle="tab" onclick="$(this).parent().find('a').removeClass('active'); $(this).addClass('active');">
                        <p class="title">Purchase</p>
                    </a>
            </div>
        </div>
    </div>

    <div class="tab-content">
        <div role="tabpanel" class="tab-pane fade in active" id="summary">
            <div class="row tb-padding">
                <div class="col-sm-4">
                    <div class="page-header">
                        <h4>Manufacturer Part No</h4>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 text-right">
                            @Model.MPN
                        </div>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="page-header">
                        <h4>SKU</h4>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 text-right">
                            @Model.Sku
                        </div>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="page-header">
                        <h4>Available Qty</h4>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 text-right">
                            @Model.Quantity
                        </div>
                    </div>
                </div>
            </div>
            <div class="row tb-padding">
                <div class="col-sm-4">
                    <div class="page-header">
                        <h4>Cost Price</h4>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 text-right">
                           @AppSettings.GetVal("CurrencySymbol") @Model.PurchasePrice
                        </div>
                    </div>
                </div>
                @*<div class="col-sm-4">
                    <div class="page-header">
                        <h4>Retail/Website Sale Price</h4>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 text-right">
                            @Model.SalePrice
                        </div>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="page-header">
                        <h4>Dropship/Associates Sale Price</h4>
                    </div>
                    <div class="row">
                        <div class="col-xs-12 text-right">
                            @Model.TradeSalePrice
                        </div>
                    </div>
                </div>*@

            </div>

            <div class="row tb-padding">
                <div class="col-sm-12">
                    <div class="page-header">
                        <h4>Specifications</h4>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    Category :
                                </div>
                                <div class="col-xs-9">
                                    @Model.CategoryTitle
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    Size :
                                </div>
                                <div class="col-xs-9">
                                    @Model.PackageSize
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    Height(cm) :
                                </div>
                                <div class="col-xs-9">
                                    @Model.Height
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    Width(cm) :
                                </div>
                                <div class="col-xs-9">
                                    @Model.Width
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    Length(cm) :
                                </div>
                                <div class="col-xs-9">
                                    @Model.Length
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-3 text-right">
                                    Stauts :
                                </div>
                                <div class="col-xs-9">
                                    @Model.ProductStatus
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row tb-padding">
                <div class="col-sm-12">
                    <div class="page-header">
                        <h4>Pricing</h4>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="row">
                                <div class="col-xs-5 text-right">
                                    Retail/Website Sale Price
                                </div>
                                <div class="col-xs-7">
                                    @AppSettings.GetVal("CurrencySymbol") @Model.SalePrice
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-5 text-right">
                                    Bulk Buyers Prices
                                </div>
                                <div class="col-xs-7">
                                    <ul class="list-group">
                                        @foreach (var x in Model.BulkPrices)
                                        {
                                            <li class="list-group-item">Quantity: @x.Quantity &nbsp; &nbsp; &nbsp; Price: @AppSettings.GetVal("CurrencySymbol") @x.Price </li>
                                        }
                                    </ul>

                                </div>
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div class="row">
                                <div class="col-xs-5 text-right">
                                    Dropship/Associates
                                </div>
                                <div class="col-xs-7">
                                   @AppSettings.GetVal("CurrencySymbol") @Model.TradeSalePrice
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="timesheet">
            <div class="row tb-padding">
                <div class="col-sm-12">
                    <div class="page-header">
                        <h4>Timesheets</h4>
                        <div class="btn-group btn-group-xs">
                            <a href="javascript://" class="btn btn-link text-muted"><i class="fa fa-clock-o"></i> Total Hours Worked: 120</a>
                            <a href="javascript://" class="btn btn-primary"><i class="fa fa-plus"></i> Create New Payroll</a>
                        </div>
                    </div>
                    <table class="table table-condensed table-hover">
                        <thead>
                            <tr>
                                <th>Project</th>
                                <th>Status</th>
                                <th>Payroll Status</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Project 1</td>
                                <td>
                                    <label class="label label-success">Approved</label>
                                </td>
                                <td>
                                    <label class="label label-success">Paid</label>
                                </td>
                                <td>
                                    40 hours
                                </td>
                            </tr>
                            <tr>
                                <td>Project 2</td>
                                <td>
                                    <label class="label label-warning">Pending</label>
                                </td>
                                <td>
                                    <label class="label label-warning">Pending</label>
                                </td>
                                <td>
                                    40 hours
                                </td>
                            </tr>
                            <tr>
                                <td>Project 1</td>
                                <td>
                                    <label class="label label-success">Approved</label>
                                </td>
                                <td>
                                    <label class="label label-danger">Un Paid</label>
                                </td>
                                <td>
                                    40 hours
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="user-timesheets-Modal" tabindex="-1" role="dialog" aria-labelledby="user-timesheets-Modal" data-backdrop="static">
    <div class="modal-dialog" role="document">
    </div>
</div>

@section scripts{
    <script>
        $(function () {
            //--- Dynamic Sections
            $("body").on("click", ".ptoRecord-Add", function () {
                var markup = '<tr class="row-Container" data-id="' + uuid + '">';
                markup += '<td><input type="text" class="form-control input-sm ptoTitle" placeholder="PTO Code Title" value="" required /></td>';
                markup += '<td></td>';
                markup += '<td class="text-right"><a href="javascript://" class="btn btn-xs btn-success saveCF"><i class="fa fa-check"></i></a><a href="javascript://" class="btn btn-xs btn-danger remCF"><i class="fa fa-times"></i></a></td>';
                markup += '</tr>';
                $("#ptoRecord-Table tbody").append(markup);
            });
            $("body").on("click", ".remCF", function () {
                var item = $(this);

                bootbox.dialog({
                    message: "Are you sure you want to delete this record, It may contain assignees which will also be deleted ?",
                    title: "Delete Record",
                    buttons: {
                        main: {
                            label: "Cancel",
                            className: "btn-default",
                            callback: function () {
                                show: false;
                            }
                        },
                        danger: {
                            label: "Delete",
                            className: "btn-danger",
                            callback: function () {
                                item.parent().parent().remove();
                                var itemId = item.attr("data-id");

                                $.ajax({
                                    type: "POST",
                                    url: "/Secure/Employee/DeletePtoRecord",
                                    data: {
                                        Id: itemId,
                                    },
                                    error: function (xhr, status, error) {
                                        alert(error);
                                    },
                                    success: function (response) {
                                        $("#PtoCodes-Container").load("/Secure/Employee/_AllPtoCodes", function () { });
                                    }
                                });
                            }
                        }
                    }
                });
            });
            $("body").on("click", ".updateIsAssignedToAll", function () {
                var itemId = $(this).attr("data-id");

                $.ajax({
                    type: "POST",
                    url: "/Secure/Employee/UpdateAssignedPtoRecord",
                    data: {
                        Id: itemId
                    },
                    error: function (xhr, status, error) {
                        alert(error);
                    },
                    success: function (response) {
                        // load the url on success
                        $("#PtoCodes-Container").load("/Secure/Employee/_AllPtoCodes", function () {});
                    }
                });
            });
            $("body").on("click", ".saveCF", function () {
                var closestRow = $(this).closest('.row-Container');
                var itemTitle = closestRow.find('.ptoTitle').val();

                $.ajax({
                    type: "POST",
                    url: "/Secure/Employee/AddPtoRecord",
                    data: {
                        Title: itemTitle
                    },
                    error: function (xhr, status, error) {
                        alert(error);
                    },
                    success: function (response) {
                        // load the url on success
                        $("#PtoCodes-Container").load("/Secure/Employee/_AllPtoCodes", function () { });
                    }
                });
            });
            //---

            $(".user-timesheets").click(function (ev) {
                $('#loading-mask').show();
                ev.preventDefault();
                var dataId = $(this).attr("data-id");
                var target = "";
                if (dataId === "") {
                    target = "/Secure/Employee/_AllTimesheets/";
                }
                else {
                    target = "/Secure/Employee/_AllTimesheets/" + dataId;
                }


                // load the url and show modal on success
                $("#user-timesheets-Modal .modal-dialog").load(target, function () {
                    $("#user-timesheets-Modal").modal("show");
                    $('#loading-mask').hide();
                });
            });
        });
    </script>
}