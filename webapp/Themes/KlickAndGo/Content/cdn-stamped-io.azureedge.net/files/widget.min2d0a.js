var StampedFn=function(e,t){function a(){var a,n=e.location;_=e.jQuery,/msie/.test(e.navigator.userAgent.toLowerCase())?(_.support.cors=!0,a=n.hash.indexOf("?"),O=-1!==a?n.hash.substring(a):""):O=n.search,_("head").append('<style>@media all{.featherlight{display:none;position:fixed;top:0;right:0;bottom:0;left:0;z-index:2147483647;text-align:center;white-space:nowrap;cursor:pointer;background:#333;background:rgba(0,0,0,0)}.featherlight:last-of-type{background:rgba(0,0,0,.8)}.featherlight:before{content:"";display:inline-block;height:100%;vertical-align:middle;margin-right:-.25em}.featherlight .featherlight-content{position:relative;text-align:left;vertical-align:middle;display:inline-block;overflow:auto;padding:25px 25px 0;border-bottom:25px solid transparent;margin-left:5%;margin-right:5%;max-height:95%;background:#fff;cursor:auto;white-space:normal}.featherlight .featherlight-inner{display:block}.featherlight .featherlight-close-icon{position:absolute;z-index:9999;top:0;right:0;line-height:25px;width:25px;cursor:pointer;text-align:center;font-family:Arial,sans-serif;background:#fff;background:rgba(255,255,255,.3);color:#000}.featherlight .featherlight-image{width:100%}.featherlight-iframe .featherlight-content{border-bottom:0;padding:0}.featherlight iframe{border:0}.featherlight *{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}} @media only screen and (max-width:1024px){.featherlight .featherlight-content{margin-left:10px;margin-right:10px;max-height:98%;padding:10px 10px 0;border-bottom:10px solid transparent}} @media all{.featherlight .featherlight-content{padding:0;border:none;min-width:inherit}.featherlight .featherlight-image{max-width:100%;border:20px solid #fff; max-width: 100%;max-height: 100%;width: auto;}}@media only screen and (max-width:1024px){.featherlight .featherlight-content{padding:0;border:none}}</style>'),_("head").append("<style>@media all{.featherlight-next,.featherlight-previous{display:block;position:absolute;top:25px;right:25px;bottom:25px;left:80%;cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:rgba(0,0,0,0)}.featherlight-previous{left:25px;right:80%}.featherlight-next:hover,.featherlight-previous:hover{background:rgba(255,255,255,.25)}.featherlight-next span,.featherlight-previous span{display:none;position:absolute;top:50%;left:5%;width:82%;text-align:center;font-size:30px;line-height:80px;margin-top:-40px;color:#fff;font-family:arial;font-style:normal;font-weight:400}.featherlight-next span{right:5%;left:auto}.featherlight-next:hover span,.featherlight-previous:hover span{display:inline-block}.featherlight-loading .featherlight-next,.featherlight-loading .featherlight-previous{display:none}}@media only screen and (max-device-width:1024px){.featherlight-next:hover,.featherlight-previous:hover{background:0 0}.featherlight-next span,.featherlight-previous span{display:block}}@media only screen and (max-width:1024px){.featherlight-next,.featherlight-previous{top:10px;right:10px;left:85%}.featherlight-previous{left:10px;right:85%}.featherlight-next span,.featherlight-previous span{margin-top:-30px;font-size:40px}}</style>"),function(a){"use strict";function i(e,t){if(!(this instanceof i)){var a=new i(e,t);return a.open(),a}this.id=i.id++,this.setup(e,t),this.chainCallbacks(i._callbackChain)}function n(e,t){var a={};for(var i in e)i in t&&(a[i]=e[i],delete e[i]);return a}function r(e,t){var a={},i=new RegExp("^"+t+"([A-Z])(.*)");for(var n in e){var r=n.match(i);r&&(a[(r[1]+r[2].replace(/([A-Z])/g,"-$1")).toLowerCase()]=e[n])}return a}if(void 0!==a){var s=[],o=function(e){return s=a.grep(s,function(t){return t!==e&&t.$instance.closest("body").length>0})},d={allowfullscreen:1,frameborder:1,height:1,longdesc:1,marginheight:1,marginwidth:1,name:1,referrerpolicy:1,scrolling:1,sandbox:1,src:1,srcdoc:1,width:1},p={keyup:"onKeyUp",resize:"onResize"},l=function(e){a.each(i.opened().reverse(),function(){return e.isDefaultPrevented()||!1!==this[p[e.type]](e)?void 0:(e.preventDefault(),e.stopPropagation(),!1)})},c=function(t){if(t!==i._globalHandlerInstalled){i._globalHandlerInstalled=t;var n=a.map(p,function(e,t){return t+"."+i.prototype.namespace}).join(" ");a(e)[t?"on":"off"](n,l)}};i.prototype={constructor:i,namespace:"featherlight",targetAttr:"data-featherlight",variant:null,resetCss:!1,background:null,openTrigger:"click",closeTrigger:"click",filter:null,root:"body",openSpeed:250,closeSpeed:250,closeOnClick:"background",closeOnEsc:!0,closeIcon:"&#10005;",loading:"",persist:!1,otherClose:null,beforeOpen:a.noop,beforeContent:a.noop,beforeClose:a.noop,afterOpen:a.noop,afterContent:a.noop,afterClose:a.noop,onKeyUp:a.noop,onResize:a.noop,type:null,contentFilters:["jquery","image","html","ajax","iframe","text"],setup:function(e,t){"object"!=typeof e||e instanceof a!=0||t||(t=e,e=void 0);var i=a.extend(this,t,{target:e}),n=i.resetCss?i.namespace+"-reset":i.namespace,r=a(i.background||['<div class="'+n+"-loading "+n+'">','<div class="'+n+'-content">','<button class="'+n+"-close-icon "+i.namespace+'-close" aria-label="Close">',i.closeIcon,"</button>",'<div class="'+i.namespace+'-inner">'+i.loading+"</div>","</div>","</div>"].join("")),s="."+i.namespace+"-close"+(i.otherClose?","+i.otherClose:"");return i.$instance=r.clone().addClass(i.variant),i.$instance.on(i.closeTrigger+"."+i.namespace,function(e){var t=a(e.target);("background"===i.closeOnClick&&t.is("."+i.namespace)||"anywhere"===i.closeOnClick||t.closest(s).length)&&(i.close(e),e.preventDefault())}),this},getContent:function(){if(!1!==this.persist&&this.$content)return this.$content;var t=this,i=this.constructor.contentFilters,n=function(e){return t.$currentTarget&&t.$currentTarget.attr(e)},r=n(t.targetAttr),s=t.target||r||"",o=i[t.type];if(!o&&s in i&&(o=i[s],s=t.target&&r),s=s||n("href")||"",!o)for(var d in i)t[d]&&(o=i[d],s=t[d]);if(!o){var p=s;if(s=null,a.each(t.contentFilters,function(){return(o=i[this]).test&&(s=o.test(p)),!s&&o.regex&&p.match&&p.match(o.regex)&&(s=p),!s}),!s)return"console"in e&&e.console.error("Featherlight: no content filter found "+(p?' for "'+p+'"':" (no target specified)")),!1}return o.process.call(t,s)},setContent:function(e){var t=this;return e.is("iframe")&&t.$instance.addClass(t.namespace+"-iframe"),t.$instance.removeClass(t.namespace+"-loading"),t.$instance.find("."+t.namespace+"-inner").not(e).slice(1).remove().end().replaceWith(a.contains(t.$instance[0],e[0])?"":e),t.$content=e.addClass(t.namespace+"-inner"),t},open:function(e){var t=this;if(t.$instance.hide().appendTo(t.root),!(e&&e.isDefaultPrevented()||!1===t.beforeOpen(e))){e&&e.preventDefault();var i=t.getContent();if(i)return s.push(t),c(!0),t.$instance.fadeIn(t.openSpeed),t.beforeContent(e),a.when(i).always(function(a){t.setContent(a),t.afterContent(e)}).then(t.$instance.promise()).done(function(){t.afterOpen(e)})}return t.$instance.detach(),a.Deferred().reject().promise()},close:function(e){var t=this,i=a.Deferred();return!1===t.beforeClose(e)?i.reject():(0===o(t).length&&c(!1),t.$instance.fadeOut(t.closeSpeed,function(){t.$instance.detach(),t.afterClose(e),i.resolve()})),i.promise()},resize:function(e,t){if(e&&t){this.$content.css("width","").css("height","");var a=Math.max(e/(parseInt(this.$content.parent().css("width"),10)-1),t/(parseInt(this.$content.parent().css("height"),10)-1));a>1&&(a=t/Math.floor(t/a),this.$content.css("width",e/a+"px").css("height",t/a+"px"))}},chainCallbacks:function(e){for(var t in e)this[t]=a.proxy(e[t],this,a.proxy(this[t],this))}},a.extend(i,{id:0,autoBind:"[data-featherlight]",defaults:i.prototype,contentFilters:{jquery:{regex:/^[#.]\w/,test:function(e){return e instanceof a&&e},process:function(e){return!1!==this.persist?a(e):a(e).clone(!0)}},image:{regex:/\.(png|jpg|jpeg|gif|tiff|bmp|svg)(\?\S*)?$/i,process:function(e){var t=this,i=a.Deferred(),n=new Image,r=a('<img src="'+e+'" alt="" class="'+t.namespace+'-image" />');return n.onload=function(){r.naturalWidth=n.width,r.naturalHeight=n.height,i.resolve(r)},n.onerror=function(){i.reject(r)},n.src=e,i.promise()}},html:{regex:/^\s*<[\w!][^<]*>/,process:function(e){return a(e)}},ajax:{regex:/./,process:function(e){var t=a.Deferred(),i=a("<div></div>").load(e,function(e,a){"error"!==a&&t.resolve(i.contents()),t.fail()});return t.promise()}},iframe:{process:function(e){var t=new a.Deferred,i=a("<iframe/>"),s=r(this,"iframe"),o=n(s,d);return i.hide().attr("src",e).attr(o).css(s).on("load",function(){t.resolve(i.show())}).appendTo(this.$instance.find("."+this.namespace+"-content")),t.promise()}},text:{process:function(e){return a("<div>",{text:e})}}},functionAttributes:["beforeOpen","afterOpen","beforeContent","afterContent","beforeClose","afterClose"],readElementConfig:function(e,t){var i=this,n=new RegExp("^data-"+t+"-(.*)"),r={};return e&&e.attributes&&a.each(e.attributes,function(){var e=this.name.match(n);if(e){var t=this.value,s=a.camelCase(e[1]);if(a.inArray(s,i.functionAttributes)>=0)t=new Function(t);else try{t=JSON.parse(t)}catch(e){}r[s]=t}}),r},extend:function(e,t){var i=function(){this.constructor=e};return i.prototype=this.prototype,e.prototype=new i,e.__super__=this.prototype,a.extend(e,this,t),e.defaults=e.prototype,e},attach:function(e,t,i){var n=this;"object"!=typeof t||t instanceof a!=0||i||(i=t,t=void 0);var r,s=(i=a.extend({},i)).namespace||n.defaults.namespace,o=a.extend({},n.defaults,n.readElementConfig(e[0],s),i),d=function(s){var d=a(s.currentTarget),p=a.extend({$source:e,$currentTarget:d},n.readElementConfig(e[0],o.namespace),n.readElementConfig(s.currentTarget,o.namespace),i),l=r||d.data("featherlight-persisted")||new n(t,p);"shared"===l.persist?r=l:!1!==l.persist&&d.data("featherlight-persisted",l),p.$currentTarget.blur&&p.$currentTarget.blur(),l.open(s)};return e.on(o.openTrigger+"."+o.namespace,o.filter,d),d},current:function(){var e=this.opened();return e[e.length-1]||null},opened:function(){var e=this;return o(),a.grep(s,function(t){return t instanceof e})},close:function(e){var t=this.current();return t?t.close(e):void 0},_onReady:function(){var e=this;e.autoBind&&(a(e.autoBind).each(function(){e.attach(a(this))}),a(t).on("click",e.autoBind,function(t){t.isDefaultPrevented()||e.attach(a(t.currentTarget))(t)}))},_callbackChain:{onKeyUp:function(e,t){return 27===t.keyCode?(this.closeOnEsc&&a.featherlight.close(t),!1):e(t)},beforeOpen:function(e,i){return this._previouslyActive=t.activeElement,this._$previouslyTabbable=a("a, input, select, textarea, iframe, button, iframe, [contentEditable=true]").not("[tabindex]").not(this.$instance.find("button")),this._$previouslyWithTabIndex=a("[tabindex]").not('[tabindex="-1"]'),this._previousWithTabIndices=this._$previouslyWithTabIndex.map(function(e,t){return a(t).attr("tabindex")}),this._$previouslyWithTabIndex.add(this._$previouslyTabbable).attr("tabindex",-1),t.activeElement.blur&&t.activeElement.blur(),e(i)},afterClose:function(e,t){var i=e(t),n=this;return this._$previouslyTabbable.removeAttr("tabindex"),this._$previouslyWithTabIndex.each(function(e,t){a(t).attr("tabindex",n._previousWithTabIndices[e])}),this._previouslyActive.focus(),i},onResize:function(e,t){return this.resize(this.$content.naturalWidth,this.$content.naturalHeight),e(t)},afterContent:function(e,t){var a=e(t);return this.$instance.find("[autofocus]:not([disabled])").focus(),this.onResize(t),a}}}),a.featherlight=i,a.fn.featherlight=function(e,t){return i.attach(this,e,t),this},a(t).ready(function(){i._onReady()})}else"console"in e&&e.console.info("Too much lightness, Featherlight needs jQuery.")}(e.jQuery),function(a){"use strict";function i(e,t){if(!(this instanceof i)){var n=new i(a.extend({$source:e,$currentTarget:e.first()},t));return n.open(),n}a.featherlight.apply(this,arguments),this.chainCallbacks(p)}var n=function(t){e.console&&e.console.warn&&e.console.warn("FeatherlightGallery: "+t)};if(void 0===a)return n("Too much lightness, Featherlight needs jQuery.");if(!a.featherlight)return n("Load the featherlight plugin before the gallery plugin");var r="ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch,s=a.event&&a.event.special.swipeleft&&a,o=e.Hammer&&function(t){var a=new e.Hammer.Manager(t[0]);return a.add(new e.Hammer.Swipe),a},d=r&&(s||o);r&&!d&&n("No compatible swipe library detected; one must be included before featherlightGallery for swipe motions to navigate the galleries.");var p={afterClose:function(e,t){var a=this;return a.$instance.off("next."+a.namespace+" previous."+a.namespace),a._swiper&&(a._swiper.off("swipeleft",a._swipeleft).off("swiperight",a._swiperight),a._swiper=null),e(t)},beforeOpen:function(e,t){var a=this;return a.$instance.on("next."+a.namespace+" previous."+a.namespace,function(e){var t="next"===e.type?1:-1;a.navigateTo(a.currentNavigation()+t)}),d&&(a._swiper=d(a.$instance).on("swipeleft",a._swipeleft=function(){a.$instance.trigger("next")}).on("swiperight",a._swiperight=function(){a.$instance.trigger("previous")}),a.$instance.addClass(this.namespace+"-swipe-aware",d)),a.$instance.find("."+a.namespace+"-content").append(a.createNavigation("previous")).append(a.createNavigation("next")),e(t)},beforeContent:function(e,t){var a=this.currentNavigation(),i=this.slides().length;return this.$instance.toggleClass(this.namespace+"-first-slide",0===a).toggleClass(this.namespace+"-last-slide",a===i-1),e(t)},onKeyUp:function(e,t){var a={37:"previous",39:"next"}[t.keyCode];return a?(this.$instance.trigger(a),!1):e(t)}};a.featherlight.extend(i,{autoBind:"[data-featherlight-gallery]"}),a.extend(i.prototype,{previousIcon:"&#9664;",nextIcon:"&#9654;",galleryFadeIn:100,galleryFadeOut:300,slides:function(){return this.filter?this.$source.find(this.filter):this.$source},images:function(){return n("images is deprecated, please use slides instead"),this.slides()},currentNavigation:function(){return this.slides().index(this.$currentTarget)},navigateTo:function(e){var t=this,i=t.slides(),n=i.length,r=t.$instance.find("."+t.namespace+"-inner");return e=(e%n+n)%n,t.$currentTarget=i.eq(e),t.beforeContent(),a.when(t.getContent(),r.fadeTo(t.galleryFadeOut,.2)).always(function(e){t.setContent(e),t.afterContent(),e.fadeTo(t.galleryFadeIn,1)})},createNavigation:function(e){var t=this;return a('<span title="'+e+'" class="'+this.namespace+"-"+e+'"><span>'+this[e+"Icon"]+"</span ></span > ").click(function(){a(this).trigger(e+"."+t.namespace)})}}),a.featherlightGallery=i,a.fn.featherlightGallery=function(e){return i.attach(this,e),this},a(t).ready(function(){i._onReady()})}(e.jQuery),jQuery.isReady?(_=e.jQuery,i()):_(t).ready(function(){_=e.jQuery,i()});_.featherlight.defaults.afterOpen=function(e){var t=_(this.$source[0]),a=_(this.$instance[0]);if("#stamped-modal-new"==this.$currentTarget.attr("data-featherlight")){var i=t.closest(".stamped-review-card"),n=_("#stamped-modal-new",a),r=_(".stamped-modal-photo",n),s=_(".stamped-modal-photo > .stamped-modal-photo-bg",n),o=_(".stamped-modal-review-date",n),d=_(".stamped-modal-review-rating",n),p=_(".stamped-modal-review-title",n),l=_(".stamped-modal-review-body",n),c=_(".stamped-modal-review-author",n),h=_(".stamped-modal-review-product a",n),m=_(".stamped-modal-review-share",n),u=_(".stamped-modal-review-vote",n);o.html(_(".stamped-reviews-date",i).html()),d.html(_(".stamped-reviews-rating",i).html()),p.html(_(".stamped-reviews-title",i).html()),l.html(_(".stamped-reviews-message",i).html()),c.html(_(".stamped-reviews-author",i).html()),h.attr("href",_(".stamped-reviews-product",i).attr("href")).html(_(".stamped-reviews-product",i).html()),u.html(_(".stamped-reviews-vote",i).html());var g=[];_(".stamped-reviews-message-image-block a",i).each(function(){g.push(_(this).attr("href"))});var f=t.attr("href"),v=g.indexOf(f),w=g[v];s.css("background-image","url("+w+")"),g.length>1&&(_(".stamped-modal-photo-arrow-right, .stamped-modal-photo-arrow-left",r).show(),_(".stamped-modal-photo-arrow-right, .stamped-modal-photo-arrow-left",r).on("click",function(){"left"==_(this).attr("data-dir")?v--:v++,(v<=0||v>g.length-1)&&(v=0);var e=g[v];s.css("background-image","url("+e+")")}));var y=_(".stamped-reviews-rating .fa-star",i).length,b=l.html(),x=_(".stamped-reviews-product",i).attr("href"),C=_(".stamped-reviews-title",i).text();if(x){var k="https://www.facebook.com/dialog/feed?app_id=222664514734026&caption="+I("★",y)+"&description="+encodeURIComponent(b)+"&display=popup&link="+encodeURIComponent(x)+"&name="+encodeURIComponent(C)+"&redirect_uri=https://stamped.io/shares?productId=",T="https://twitter.com/intent/tweet?text="+b.substr(0,140)+"&url="+encodeURIComponent(x),$="https://plus.google.com/share?url="+encodeURIComponent(x);_("<a>").text("Facebook").attr("href",k).attr("target","_blank").appendTo(m),_("<a>").text("Twitter").attr("href",T).attr("target","_blank").appendTo(m),_("<a>").text("Google").attr("href",$).attr("target","_blank").appendTo(m)}}}}function i(){if(P=_("#stamped-main-widget"),_.trim(_("#stamped-main-widget").html())?(r(),h(),c(),o(),_(".stamped-sort-select").length||_(".stamped-tab-container").append('<select class="stamped-sort-select" onchange="StampedFn.sortReviews(this);"> <option value="recent">Most recent</option> <option value="highest-rating">Highest Rating</option> <option value="lowest-rating">Lowest Rating</option> <option value="most-votes">Most Votes</option> <option value="least-votes">Least Votes</option> </select>')):(n(),_(t).on("stamped:reviews:loaded",function(e){r(),h(),c(),o()})),s(),p(),l(),u(),m(),d(),_("#stamped-reviews-widget").length>0){var e=A+"/widget/reviews";_("[id=stamped-reviews-widget]").each(function(t){C(e,_(this))})}var a=F("stamped_r_id");a&&_.ajax({type:"GET",url:"//stamped.io/api/widget/reviews",data:{reviewIds:a,apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl,type:"single",showAvatar:"True"},success:function(e){e=e.data[0];var a='<div class="stamped-ratings-wrapper stamped-review-card" id="stamped-review-modal-single" style="display:none;"> <div class="stamped-reviews-rating"> <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i></div> <div class="stamped-reviews-date"> {0}</div> <div class="stamped-reviews-author"> {2}</div> <div class="stamped-reviews-title"><a href="{1}">{3}</a></div> <div class="stamped-reviews-message"> <div class="stamped-reviews-message-block">{4}</div> <div class="stamped-reviews-message-image-block"> <a href="{5}" target="_blank" data-featherlight="#stamped-modal-new"> <img src="{6}" height="50" style="margin-right:5px;"> </a> </div> </div> </div>'.format(e.reviewDate,e.productUrl,e.author,e.reviewTitle,e.reviewMessage,e.productImageLargeUrl,e.productImageUrl);_(t.body).append(_(a)),_(t.body).append(_('<div id="stamped-modal-new" style="display:none;"> <div class="stamped-modal-photo"> <div class="stamped-modal-photo-bg" style="height: 100%;width: 100%;display: block;background-size: cover;background-repeat: no-repeat;background-position: center center;"></div> <div class="stamped-modal-photo-arrow-right" data-dir="right">&raquo;</div> <div class="stamped-modal-photo-arrow-left" data-dir="left">&laquo;</div> </div> <div class="stamped-modal-content"> <div class="stamped-modal-review-date"></div> <div class="stamped-modal-review-rating"></div> <div class="stamped-modal-review-title"></div> <div class="stamped-modal-review-body"></div> <div class="stamped-modal-review-author"></div> <div class="stamped-modal-review-product"> <a href=""></a> </div> </div> </div>')),_("head").append("<style>.stamped-modal-photo, .stamped-modal-content { float:left; width:450px; height:500px; position:relative; } .stamped-modal-photo { background:#191717; } .stamped-modal-content { margin:0; padding:40px 20px; font-size:1.1em; } .stamped-modal-review-date { float: right; color: #aaa; margin-top: 10px; } .stamped-modal-review-rating { margin-top:10px; } .stamped-modal-review-title { font-weight: bold; font-size:1.2em; margin:15px 0; } .stamped-modal-review-body { margin-top: 10px; } .stamped-modal-review-author:before { content: ' - Review by '; margin-top: 15px; } .stamped-modal-review-author { margin-top: 10px; font-style: italic; color: #999; } .stamped-modal-product { margin-top:10px; } .stamped-modal-product a { color:#2196f3; } .stamped-modal-photo img { max-height: 100%; max-width: 100%; width: auto; height: auto; position: absolute; top: 0; bottom: 0; left: 0; right: 0; margin: auto; } .stamped-modal-photo-arrow-right,.stamped-modal-photo-arrow-left { position: absolute; top: 49%; font-size: 30px; cursor: pointer; display:none; } .stamped-modal-photo-arrow-right { right: 20px; } .stamped-modal-photo-arrow-left { left: 20px; } .stamped-modal-content .stamped-reviews-message-image-block { display:none; } .featherlight { background: rgba(0,0,0,.8); } .stamped-modal-content .fa-star-half-o:before, .stamped-modal-content .fa-star-o:before, .stamped-modal-content .fa-star:before { font-size: 25px !important; } .featherlight #stamped-modal-new { display:block !important; } @media screen and (max-width: 590px) { .stamped-modal-photo, .stamped-modal-content { width: 100% !important; height: 300px !important; } }"),setTimeout(function(){_('#stamped-review-modal-single a[data-featherlight="#stamped-modal-new"]').click()},3e3)},error:function(e){}})}function n(){g()}function r(){f()}function s(){b()}function o(){var e=_(P).attr("data-limit-words");e&&e>0&&_(".stamped-review").each(function(t){var a=_(".stamped-review-content-body:first",this);if(a.length){var i=_(a).html(),n=i.split(" ");n.length>e&&(txtTrimmed=n.slice(0,e).join(" ")+"...",_(a).html(txtTrimmed),_(a).append('<a class="stamped-review-read-more" style="margin-left:10px; cursor:pointer;">read more</span>'),_(a).append('<span class="original-review" style="display:none !important;">'+i+"</span>"))}}),_(".stamped-review-content-body").on("click",".stamped-review-read-more",function(){_(this).closest(".stamped-review-content-body").find(".stamped-review-read-more").hide();var e=_(this).closest(".stamped-review-content-body").find(".original-review").html();_(this).closest(".stamped-review-content-body").html(e)})}function d(){_(t).on("click",".stamped-share-button,.stamped-share-icon",function(){_(this).parent().find(".stamped-share-links").fadeToggle()})}function p(){_(t).on("click",".stamped-summary-ratings .summary-rating",function(){var e=_(this).find(".summary-rating-bar"),t=e.attr("data-rating"),a=e.hasClass("selected");_(".stamped-summary-ratings .summary-rating").each(function(){_(this).removeClass("selected")}),_(".summary-rating-bar").each(function(){_(this).removeClass("selected")}),t&&(a?(j(1),_(".stamped-summary-ratings").removeClass("selected")):(e.addClass("selected"),_(this).addClass("selected"),_(".stamped-summary-ratings").addClass("selected"),j(1)))})}function l(){_(t).on("mouseover mouseout",".stamped-form-review-rating a.fa",function(e){var t,a,i;t=e.currentTarget,i=_(t).attr("data-value"),a=_(t).parent(),"mouseover"===e.type?(a.find("a.fa:lt("+i+")").removeClass("fa-star-o").addClass("fa-star"),a.find("a.fa:gt("+(i-1)+")").removeClass("spr-icon-star-hover").addClass("fa-star-o")):a.find("a.fa").removeClass("fa-star").addClass("fa-star-o")})}function c(){function a(e){var t=new FileReader;t.onloadend=function(){console.log("process file"),i(t.result,e.type,e.name)},t.onerror=function(){console.log("There was an error reading the file!")},t.readAsDataURL(e)}function i(e,a,i){var r=new Image;r.src=e,r.onload=function(){var s=z.length,o=r.width,d=r.height;if(!(o>2500||d>2500))return _(".stamped-file-holder").append('<div class="stamped-file-photo" data-index="'+s+'"><i class="fa fa-spin fa-spinner" /><img src="'+e+'" width="70" /><span style="display:none;">'+i+"</span></div>"),void n(e,s);var p,l;o>d?(l=d*(2500/o),p=2500):(p=o*(2500/d),l=2500);var c=t.createElement("canvas");c.width=p,c.height=l,c.getContext("2d").drawImage(this,0,0,p,l),e=c.toDataURL(a),_(".stamped-file-holder").append('<div class="stamped-file-photo" data-index="'+s+'"><i class="fa fa-spin fa-spinner" /><img src="'+e+'" width="70" /><span style="display:none;">'+i+"</span></div>"),n(e,s)},r.onerror=function(){console.log("There was an error processing your file!")}}function n(e,a){var i=P.attr("data-product-id"),n={imagea:e.replace(/^data:image\/(png|jpg|jpeg|gif);base64,/,"")};_(t).trigger("stamped:photo:uploading"),_(".stamped-button-primary",P).attr("disabled","disabled"),_.ajax({type:"POST",url:"//stamped.io/api/widget/upload?"+_.param(k({productId:i,apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl})),data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){setTimeout(function(){e&&(z.push(e),s(e,a))},1e3),_(t).trigger("stamped:photo:uploaded"),_(".stamped-button-primary",P).removeAttr("disabled")},error:function(e){z.length;'"max"'==e.responseText?alert("Upload up to 3 images"):console.log("An error occured, please try again later."),_(t).trigger("stamped:photo:uploaded"),_(".stamped-button-primary",P).removeAttr("disabled")}})}if(e.File&&e.FileReader&&e.FormData){var r=_("#stamped-file-uploader-input");r.on("change",function(e){var i=e.target.files[0];if(i)if(/^image\//i.test(i.type)){if(console.log("is image, begin upload"),z.length>=3)return void _(t).trigger("stamped:photo:maxed");a(i),r.val("")}else _(t).trigger("stamped:photo:invalid"),console.log("Not a valid image!")})}else console.log("File upload is not supported!");var s=function(e,t){_(".stamped-file-photo:eq("+t+") .fa").remove()}}function h(){var e=_('.stamped-photos-carousel div[class="photo"] img'),a=e.length;e.length&&e.on("load",function(){--a||setTimeout(function(){_('.stamped-photos-carousel div[class="photo"]').length;_(".stamped-summary-photos .btn-slide-left").hide(),_(".stamped-summary-photos .btn-slide-right").hide();var e=1,a=_(".stamped-summary-photos"),i=_("<div />").appendTo(_("body"));i.css({position:"absolute !important",visibility:"hidden !important",display:"block !important"}),$carousel=_(a).clone().appendTo(i);var n=0,r=$carousel.width()<100?280:$carousel.width();_('div[class="photo"] img',$carousel).each(function(e){n+=parseInt(_(this).width())+5}),$carousel.remove();a=_(".stamped-photos-carousel");n>r&&_(".stamped-summary-photos .btn-slide-right").show(),_(t).on("click",".stamped-summary-photos .btn-slide-right, .stamped-summary-photos .btn-slide-left",function(){K="left"==_(this).attr("data-direction")?-1:1,a.attr("data-page")&&(e=parseInt(a.attr("data-page"))),0==(e+=K)&&(e=1),1==e?_(".stamped-summary-photos .btn-slide-left").hide():_(".stamped-summary-photos .btn-slide-left").show();var t=a[0].offsetWidth*(-1*(e-1));-1*t-r>=n-r||(_(a).attr("data-page",e),-1*t+r>n?(t=-1*(n-r),_(".stamped-summary-photos .btn-slide-right").hide()):_(".stamped-summary-photos .btn-slide-right").show(),a.attr("style","left: "+t+"px"))})},3e3)}).filter(function(){return this.complete}).trigger("load")}function m(){_(t).on("click","#shopry-rating-wrapper a.shopry-thumbs-up, #shopry-rating-wrapper a.shopry-thumbs-down, #shopry-rating-holder a.shopry-thumbs-up, #shopry-rating-holder a.shopry-thumbs-down, #stamped-rating-holder a.stamped-thumbs-up, #stamped-rating-holder a.stamped-thumbs-down, .stamped-rating-holder a.stamped-thumbs-up, .stamped-rating-holder a.stamped-thumbs-down",function(e){var t=_(this).attr("data-review-id"),a=_(this).attr("data-rating"),i=P.attr("data-product-id"),n=_(this);n.parent().fadeTo("slow",.3),n.addClass("disable-link"),_.ajax({type:"POST",url:A+"/reviews/vote",data:{productId:i,reviewId:t,vote:a,apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl},success:function(e){if(1==e||-1==e){var t=n.find(".fa").html();t=t.replace("&nbsp;","").trim();var a=parseInt(t);n.find(".fa").html("&nbsp; "+(a+e))}n.parent().fadeTo("slow",1),n.removeClass("disable-link")}})})}function u(){_(t).on("click",".stamped-tabs li",function(e){y(this)})}function g(e,a,i,n){if(P.length&&!W){var r=P.attr("data-product-id"),s=P.attr("data-product-ids"),o=P.attr("data-name"),d=P.attr("data-product-type"),p=P.attr("data-product-sku"),l=P.attr("data-user-reference"),c=P.attr("data-take-reviews");1==D&&console.log(richSnippet),a||(a=P.attr("data-sort")),_("#stamped-main-widget-placeholder").length&&_("#stamped-main-widget-placeholder").append(P),W=!0,_.ajax({type:"GET",url:A+"/widget?"+_.param(k({productId:r,productIds:s,productName:o,productType:d,productSKU:p,userReference:l,page:e||1,apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl,take:c||5,sort:a,rating:i})),success:function(i){W=!1;var r=_(P).attr("data-rich-snippet"),s=i.product,o=i.widget;if(!e&&"false"!=r&&i.title){r={"@context":"http://schema.org","@type":"Product",name:i.title,aggregateRating:{"@type":"AggregateRating",ratingValue:i.rating,reviewCount:i.count}};if(i.count>0){var d=t.createElement("script");d.type="application/ld+json",d.innerHTML=JSON.stringify(r),t.getElementsByTagName("head")[0].appendChild(d)}}var p=_("#stamped-main-widget .stamped-container").length,l=_(".question-form-wrapper").clone(),c=_(".stamped-questions").clone();p?_(".stamped-content",P).html(o):(P.html(s),_(".stamped-content",P).html(o)),l.length&&!_(".stamped-questions-placeholder").length&&l.insertAfter(_(".stamped-tab-container",P)),c.length&&!_(".stamped-questions-placeholder").length&&_(".stamped-questions",P).replaceWith(c),a&&_(".stamped-sort-select").length&&"none"!=_('.stamped-sort-select option[value="'+a+'"]').css("display")&&_(".stamped-sort-select").val(a),e&&!n&&$(".stamped-tab-container"),_(t).trigger("stamped:reviews:loaded")},error:function(e){}})}}function f(e,a){if((P=_("#stamped-main-widget")).length){var a=P.attr("data-product-id"),i=P.attr("data-product-sku"),n=P.attr("data-take-questions")||5;_.ajax({type:"GET",url:"//stamped.io/api/widget/questions",data:{productId:a,productSKU:i,page:e||1,apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl,take:n||5},success:function(a){if(1==a.a&&_(".stamped-questions").length){var i,r,s,o;i=a.result,r=a.t,s=a.form,a.p,o=a.avatar;var d=_("#tab-questions").text().split(" ");_("#tab-questions").html(d[0]+" ("+r+")"),v(s);var p=_('<div class="stamped-questions">');if(_(".stamped-questions").html(""),p.append(i),o){var l=_(".stamped-review #stamped-review-avatar",p),c=_('<img src="'+o+'" width="100">');l.html(c)}var h=_(".stamped-questions-placeholder");h.length?(_(".stamped-questions",h).html(""),_(".stamped-questions",h).replaceWith(p),_(".stamped-questions",h).length||(_(".stamped-questions").appendTo(h),_(".stamped-questions").replaceWith(p)),_(".stamped-questions",h).show(),_("#tab-questions").hide(),_(".question-form-wrapper").prependTo(h),_(".stamped-summary-actions-newquestion").prependTo(h)):(_(".stamped-questions").replaceWith(p),e?_(".stamped-questions").show():_(".stamped-questions").hide()),w(r,e||1,n),e&&$("#stamped-main-widget"),_(".stamped-review-reply-body",p).each(function(){var e=_(this).html();_(this).html(e.linkify())}),_(t).trigger("stamped:questions:loaded")}}})}}function v(e){if(_(".stamped-questions").length&&!_(".question-form-wrapper").length){var t=_('<div class="question-form-wrapper">').html(e);_(".new-review-form").before(t)}}function w(e,t,a){var i=e>0?e/a<1?1:Math.ceil(e/a):1;if(1!=i){var n='<div class="stamped-pagination" id="stamped-pagination-question"><div><span id="stamped-pagination-prev" class="stamped-pagination-prev"><a onclick="StampedFn.pageQuestions(this)" data-product-id="" data-page="'+(t-1)+'">&laquo; Previous</a></span><span id="pages"></span><span id="stamped-pagination-next" class="stamped-pagination-next"><a onclick="StampedFn.pageQuestions(this)" data-product-id="" data-page="'+(t+1)+'">Next &raquo;</a></span></div></div>',r=_(".stamped-questions"),s=_(".stamped-questions-placeholder");s.length&&(r=_(".stamped-questions",s));var o=_(".stamped-pagination",r);o.length?o.replaceWith(n):r.append(n),o=_(".stamped-pagination",r);var e=i,t=t,d=[];if(d.push(1),e<=7){for(l=2;l<e;l++)d.push(l);e==t&&d.push(t)}if(e>=8){t-2>=1&&(t-2!=1&&d.push(t-2),d.push(t-1)),1!=t&&d.push(t);var p=t+2;p<=e&&(d.push(t+1),p!=e&&d.push(t+2))}1==t||1==t?_("#stamped-pagination-prev",o).hide():_("#stamped-pagination-prev",o).show(),e==t||1==e?_("#stamped-pagination-next",o).hide():_("#stamped-pagination-next",o).show(),e!=t&&d.push(e);for(var l=0;l<d.length;l++)d[l]==t?_("#pages",o).append(' <span class="page active">'+d[l]+"</span> "):_("#pages",o).append(' <span class="page"><a style="cursor:pointer;" onclick="StampedFn.pageQuestions(this)" data-product-id="" data-page="'+d[l]+'">'+d[l]+"</a></span> "),1==d[l]&&e>7&&t>=5&&_("#pages",o).append(' <span class="stamped-pagination-deco">&hellip;</span>'),l==d.length-2&&t+2<e&&_("#pages",o).append(' <span class="stamped-pagination-deco">&hellip;</span>')}}function y(e,t){_("#stamped-questions-placeholder").length||(_(".stamped-tabs #tab-reviews").removeClass("active"),_(".stamped-tabs #tab-questions").removeClass("active"),"questions"==t?_(".stamped-tabs #tab-questions").addClass("active"):"reviews"==t&&_(".stamped-tabs #tab-reviews").addClass("active"),e&&(_(e).addClass("active"),t=_(e).data("type")),"reviews"==t?(_(".stamped-reviews").show(),_(".stamped-questions").hide()):"questions"==t&&(_(".stamped-reviews").hide(),_(".stamped-questions").show()),_(".new-review-form").hide(),_(".new-question-form").hide())}function b(){var e;(N=_(".stamped-product-reviews-badge[data-id]")).length&&(e=_.map(N,function(e){if(!_.trim(_(e).html())||_(e).attr("data-type")||_(e).attr("data-product-type")||_(e).attr("data-product-sku"))return{productId:_(e).attr("data-id"),productType:_(e).attr("data-product-type"),productSKU:_(e).attr("data-product-sku")}})),_(".stamped-product-reviews-badge[data-id].stamped-main-badge, .stamped-product-reviews-badge:first").length&&_(t).on("click",".stamped-product-reviews-badge[data-id].stamped-main-badge, .stamped-product-reviews-badge:first",function(){"qna"==_(this).attr("data-type")?(_("#stamped-questions-placeholder").length?$("#stamped-questions-placeholder"):(y(null,"questions"),$("#stamped-main-widget")),_(".stamped-badge-caption[data-questions]").length&&"0"==_(".stamped-badge-caption[data-questions]").attr("data-questions")&&_(".new-question-form").show()):$("#stamped-main-widget")}),e&&e.length&&_.ajax({type:"POST",url:A+"/widget/badges",data:{productIds:e,apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl},success:function(e){N.each(function(t){var a=_(this).attr("data-id"),i=_(this).attr("data-type"),n=_.map(e,function(e,t){if(e.productId==a)return t})[0];n>=0&&(!i||"review"==i)?_(this).html(e[n].badge):n>=0&&"qna"==i&&_(this).html(e[n].badgeqna)})},error:function(e){}})}function x(e){var t="https://www.facebook.com/dialog/feed?app_id=222664514734026&caption="+I("★",e.reviewRating)+"&description="+encodeURIComponent(e.reviewMessage)+"&display=popup&link="+encodeURIComponent(e.productUrl)+"&name="+encodeURIComponent(e.reviewTitle)+"&redirect_uri=https://stamped.io/shares?productId="+e.productId,a="https://twitter.com/intent/tweet?text="+e.reviewMessage.substr(0,140)+"&url="+encodeURIComponent(e.productUrl),i="https://plus.google.com/share?url="+encodeURIComponent(e.productUrl),n=_(".stamped-thank-you .stamped-share-links");_(".facebook",n).attr("href",t),_(".twitter",n).attr("href",a),_(".google",n).attr("href",i)}function C(a,i,n){var r=_(i),s=r.data("widget-type"),o=r.data("review-id"),d=r.data("review-ids")?r.data("review-ids").toString().split(","):null,p=r.data("product-id"),l=r.data("product-ids")?r.data("product-ids").toString().split(","):null,c=r.data("product-category"),h=r.data("product-brand"),m=r.data("limit-words"),u=r.data("random"),g=r.data("show-avatar"),f=r.data("take"),v=r.data("fill-empty"),w=r.data("min-rating"),y=r.data("with-photos");_.ajax({type:"GET",url:a+"?"+_.param(k({type:s,reviewId:o,reviewIds:d,productId:p,productIds:l,productCategory:c,productBrand:h,limitWords:m,random:u,showAvatar:g,isFillEmpty:v,apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl,page:n,skip:f,minRating:w,isWithPhotos:y})),dataType:"json",success:function(a,n,o){if(a){var d=a.template;if("instagram-feed"!=s&&_(r).html(""),"single"==s)r.append(d),StampedWidgetSingleFn,StampedWidgetSingleFn.init(a.data,r,_);else if("full-page"==s){var p=r.attr("data-rich-snippet"),l="/"==location.pathname;if(a.total>0&&"true"==p&&!l){c={"@context":"http://schema.org","@type":"Product",name:a.shop,aggregateRating:{"@type":"AggregateRating",ratingValue:a.rating,reviewCount:a.total}};(h=t.createElement("script")).type="application/ld+json",h.innerHTML=JSON.stringify(c),t.getElementsByTagName("head")[0].appendChild(h)}r.append(d),StampedWidgetFullPageFn,StampedWidgetFullPageFn.init(a,r,_)}else if("people-highlight"==s)r.append(d),StampedWidgetPeopleHighlightFn,StampedWidgetPeopleHighlightFn.init(a,r,_);else if("drawer"==s)r.append(d),StampedWidgetDrawerFn,StampedWidgetDrawerFn.init(a,r,_);else if("carousel"==s)r.append(d),StampedCarouselFn,StampedCarouselFn.init(a,r,_);else if("carousel-photos"==s)r.append(d),StampedCarouselPhotosFn,StampedCarouselPhotosFn.init(a.data,r,_);else if("instagram-feed"==s)e.stampedInstagramDataArr||i.append(d),StampedInstagramFeedFn,StampedInstagramFeedFn.init(a,r,_);else if("site-badge"==s){var p=r.attr("data-rich-snippet"),l="/"==location.pathname;if(a.total>0&&"true"==p&&!l){var c={"@context":"http://schema.org","@type":"Product",name:a.shop,aggregateRating:{"@type":"AggregateRating",ratingValue:a.rating,reviewCount:a.total}},h=t.createElement("script");h.type="application/ld+json",h.innerHTML=JSON.stringify(c),t.getElementsByTagName("head")[0].appendChild(h)}r.append(d),StampedSiteBadgeFn,StampedSiteBadgeFn.init(a,r,_)}else"top-rated"==s?(r.append(d),StampedTopRatedFn,StampedTopRatedFn.init(a,r,_)):"wall-photos"==s?(r.append(d),StampedWallPhotosFn,StampedWallPhotosFn.init(a,r,_)):"checkout-comments"==s&&(r.append(d),StampedCheckoutCommentsFn,StampedCheckoutCommentsFn.init(a,r,_))}}})}function k(e){for(var t in e)null!==e[t]&&""!==e[t]&&void 0!==e[t]||delete e[t];return e}function T(e){var t={},a=_(e).serializeArray();return _.each(a,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}function I(e,t){for(var a=[],i=0;i<t;)a[i++]=e;return a.join("")}function $(e){if(_(e).length){var t=_("#stamped-main-widget").attr("data-animation");if("false"==t);else{var a=_(e),i=_("html, body");i.on("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove",function(){i.stop()}),i.animate({scrollTop:a.offset().top-1},t||500,function(){i.off("scroll mousedown wheel DOMMouseScroll mousewheel keyup touchmove")})}}}function q(e,t){t.find("a:lt("+e+")").removeClass("fa-star-o").addClass("fa-star-checked"),t.find("a:gt("+(e-1)+")").removeClass("fa-star-checked").addClass("fa-star-o")}function S(i){(E=i)&&E.apiKey&&(e.jQuery?a():e.onload=function(e){(R=t.createElement("script")).type="text/javascript",R.charset="UTF-8",R.src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js",t.body.appendChild(R),R.onload=R.onreadystatechange=a})}function j(e,t){P.attr("data-product-id");var a=_(".stamped-summary-ratings.selected .summary-rating-bar.selected",P).attr("data-rating");a&&(t=a);var i;_(".stamped-sort-select").length&&(i=_(".stamped-sort-select").val()),g(e,i,t)}function F(t,a){a||(a=e.location.href),t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(a);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function U(){_=e.jQuery,jQuery.ajax({type:"GET",url:"//stamped.io/api/shopify/getappkey",data:{shopShopifyDomain:Shopify.shop},success:function(e){e&&(1==e.skip||(appKey=e.apiKey,S({apiKey:appKey,storeUrl:Shopify.shop})))}})}var R,_,O,E,K,A="https://stamped.io/api",z=(t.getElementsByTagName("script"),e.location.hostname,[]),W=!1,D=!1;String.prototype.format=function(){for(var e=this,t=0;t<arguments.length;t++){var a=new RegExp("\\{"+t+"\\}","gi");e=e.replace(a,arguments[t])}return e};var P,N=[];String.linkify||(String.prototype.linkify=function(){var e=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gim,t=/(^|[^\/])(www\.[\S]+(\b|$))/gim,a=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gim;return this.replace(e,'<a href="$&">$&</a>').replace(t,'$1<a href="http://$2">$2</a>').replace(a,'<a href="mailto:$&">$&</a>')});var Q=t.getElementById("stamped-script-widget"),M="";if(Q&&(M=Q.src),M.indexOf("skipCss=true")<0&&function(e){for(var a=t.styleSheets,i=0,n=a.length;i<n;i++)if(a[i]&&a[i].href&&a[i].href.indexOf(e)>-1)return;var r=t.getElementsByTagName("head")[0],s=t.createElement("link");s.rel="stylesheet",s.type="text/css",s.href=e,s.setAttribute("async",""),r.appendChild(s)}("//cdn-stamped-io.azureedge.net/files/widget.min.css"),"undefined"!=typeof Shopify){var B=!1;if(Shopify.shop){if(null!=Q){M.indexOf("skip=true")>-1&&(B=!0),M.indexOf("debug=true")>-1&&(D=!0);var H=Q.getAttribute("data-api-key");!H&&M.indexOf("apiKey")>-1&&(H=F("apiKey",M)),H&&(B=!0,S({apiKey:H,storeUrl:Shopify.shop}))}B||(e.jQuery?U():e.onload=function(e){(R=t.createElement("script")).type="text/javascript",R.charset="UTF-8",R.src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js",t.body.appendChild(R),R.onload=R.onreadystatechange=U})}}return{init:S,toggleForm:function(e){if("review"==e)y(null,"reviews"),t=_(".new-review-form"),(a=_(".new-question-form")).hide(),t.hasClass("stamped-visible")?(t.hide(),t.removeClass("stamped-visible")):(t.show(),t.addClass("stamped-visible"));else if("question"==e){y(null,"questions");var t=_(".new-question-form"),a=_(".new-review-form");a.hide(),"block"==t.css("display")?t.hide():t.show()}},setRating:function(e){var t,a,i;t=_(e).parents("form"),i=_(e).attr("data-value"),a=_(e).parent(),t.find("input[name='reviewRating']").val(i),q(i,a)},submitForm:function(e){var a=_(e).hasClass("edit-review-form"),i="POST",n=null;a&&(i="PUT");var r;if(((r=T(e)).reviewRating||a)&&r.author){var s={productName:P.attr("data-name"),productId:P.attr("data-product-id"),productSKU:P.attr("data-product-sku"),productDescription:P.attr("data-description"),productImageUrl:P.attr("data-image-url"),productUrl:P.attr("data-url"),reviewSource:"widget",userReference:P.attr("data-userReference")};r=_.extend(r,s),n=r,r=(r=_.param(r)).replace(/%0D%0A/g,"%0A"),_.ajax({url:A+"/reviews2?"+_.param(k({apiKey:E.apiKey,sId:E.sId,storeUrl:E.storeUrl,photos:z.join()})),type:i,data:r,beforeSend:function(e){_(".stamped-button-primary",P).attr("disabled","disabled")},error:function(e){_(t).trigger("stamped:reviews:submitError"),_(".stamped-button-primary",P).attr("disabled","disabled")},success:function(e){_("#stamped-main-widget").length&&(x(n),_(".stamped-user-review",P).hide(),_(".stamped-thank-you",P).show(),_(".new-review-form",P).hide(),_(".edit-review-form",P).hide(),_(".stamped-summary-actions-newreview").hide(),_(".stamped-button-primary",P).removeAttr("disabled"),$("#stamped-main-widget")),_(t).trigger("stamped:reviews:submitted")}})}},submitQuestionForm:function(){var e=_("#new-question-form"),t=_("#stamped-main-widget");if(e.length&&t.length){var a=t.data("name"),i=t.data("description"),n=t.data("product-sku"),r=t.data("url"),s=t.data("image-url"),o=e.serializeArray();o.push({name:"productName",value:a}),o.push({name:"productDescription",value:i}),o.push({name:"productSKU",value:n}),o.push({name:"productUrl",value:r}),o.push({name:"productImageUrl",value:s}),o.push({name:"apiKey",value:E.apiKey}),o.push({name:"sId",value:E.sId}),o.push({name:"storeUrl",value:E.storeUrl}),_('input[type="submit"]',e).attr("disabled","disabled"),_.ajax({type:"POST",url:"//stamped.io/api/questions",data:_.param(o),crossDomain:!0,success:function(t){t.a&&(_("#new-question-form").hide(),_(".stamped-form-message-success").show(),_("#new-question-form")[0].reset(),_('input[type="submit"]',e).removeAttr("disabled"))}})}},toggleFormEdit:function(){_(".edit-review-form",P).toggle()},pageQuestions:function(e){var t=P.attr("data-product-id");f(_(e).data("page"),t)},pageReviews:j,sortReviews:function(e){P.attr("data-product-id");e.value&&g(1,e.value,null,!0)},pageWidget:function(e){var t=_(e).data("page"),a=A+"/widget/reviews",i=_(e).closest("#stamped-reviews-widget");i.attr("data-page",t),C(a,i,t)},loadBadges:s}}(window,document);